
---
layout: colab
title:  Convert colab to html
date:   2024-03-23
---


<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p><a href="https://colabcademy.com"><img src="https://raw.githubusercontent.com/eddyjin1/colab/gh-pages/colab_logo.png" width=200></a></p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p><strong>Convert colab to html</strong></p>
<p>This colab takes a colab and converts it to an HTML page.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-python"><pre><span></span><span class="c1">#@title Paths</span>
<span class="n">colab_path</span> <span class="o">=</span> <span class="s1">'/content/drive/My Drive/Colab Notebooks/Convert colab to html'</span> <span class="c1">#@param{type:'string'}</span>
<span class="n">output_folder_path</span> <span class="o">=</span> <span class="s1">'/content/drive/My Drive/colabcademy/htmls/'</span> <span class="c1">#@param{type:'string'}</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-python"><pre><span></span><span class="c1">#@title Convert full colab to full HTML</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"/content/drive"</span><span class="p">):</span>
  <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'/content/drive'</span><span class="p">)</span>

<span class="c1"># Read notebook from drive</span>
<span class="kn">import</span> <span class="nn">nbformat</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">colab_path</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">notebook</span> <span class="o">=</span> <span class="n">nbformat</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">as_version</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Convert notebook to html</span>
<span class="kn">from</span> <span class="nn">nbconvert</span> <span class="kn">import</span> <span class="n">HTMLExporter</span>
<span class="n">html_exporter</span> <span class="o">=</span> <span class="n">HTMLExporter</span><span class="p">()</span>
<span class="n">html_exporter</span><span class="o">.</span><span class="n">template_name</span> <span class="o">=</span> <span class="s1">'classic'</span>
<span class="n">html_output</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">html_exporter</span><span class="o">.</span><span class="n">from_notebook_node</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>

<span class="c1"># Create HTML filename</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">colab_path</span><span class="p">)</span>
<span class="n">title</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">html_filename</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.html'</span>
<span class="n">html_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder_path</span><span class="p">,</span> <span class="n">html_filename</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">html_path</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
  <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html_output</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-python"><pre><span></span><span class="c1">#@title Convert only colab body to HTML</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"/content/drive"</span><span class="p">):</span>
  <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'/content/drive'</span><span class="p">)</span>

<span class="c1"># Read notebook from drive</span>
<span class="kn">import</span> <span class="nn">nbformat</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">colab_path</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">notebook</span> <span class="o">=</span> <span class="n">nbformat</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">as_version</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Convert notebook to html</span>
<span class="kn">from</span> <span class="nn">nbconvert</span> <span class="kn">import</span> <span class="n">HTMLExporter</span>
<span class="n">html_exporter</span> <span class="o">=</span> <span class="n">HTMLExporter</span><span class="p">()</span>
<span class="n">html_exporter</span><span class="o">.</span><span class="n">template_name</span> <span class="o">=</span> <span class="s1">'classic'</span>
<span class="n">html_output</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">html_exporter</span><span class="o">.</span><span class="n">from_notebook_node</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>

<span class="c1"># Extract body only</span>
<span class="n">body_start</span> <span class="o">=</span> <span class="s1">'&lt;body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light"&gt;'</span>
<span class="n">body_end</span> <span class="o">=</span> <span class="s1">'&lt;/body&gt;'</span>
<span class="n">start_index</span> <span class="o">=</span> <span class="n">html_output</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">body_start</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">body_start</span><span class="p">)</span>
<span class="n">end_index</span> <span class="o">=</span> <span class="n">html_output</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">body_end</span><span class="p">)</span>
<span class="n">body_content</span> <span class="o">=</span> <span class="n">html_output</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">]</span>

<span class="c1"># Create HTML filename</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">colab_path</span><span class="p">)</span>
<span class="n">title</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">html_filename</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.html'</span>
<span class="n">html_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder_path</span><span class="p">,</span> <span class="n">html_filename</span><span class="p">)</span>

<span class="c1"># Add Front Matter</span>
<span class="n">body_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">---</span>
<span class="s2">layout: colab</span>
<span class="s2">title:  </span><span class="si">{</span><span class="n">title</span><span class="si">}</span>
<span class="s2">date:   </span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span><span class="si">}</span>
<span class="s2">---</span>
<span class="s2">"""</span> <span class="o">+</span> <span class="n">body_content</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">html_path</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
  <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">body_content</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-python"><pre><span></span><span class="c1"># prompt: save a file directly to github</span>

<span class="c1"># !pip install google-auth-oauthlib</span>
<span class="c1"># !pip install PyGithub</span>
<span class="c1"># from google.colab import auth</span>
<span class="c1"># auth.authenticate_user()</span>

<span class="c1"># import requests</span>
<span class="c1"># import json</span>
<span class="c1"># import base64</span>

<span class="c1"># Get credentials</span>
<span class="c1"># credentials = requests.get('http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token', headers={'Metadata-Flavor': 'Google'}).json()</span>

<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">userdata</span>
<span class="kn">from</span> <span class="nn">github</span> <span class="kn">import</span> <span class="n">Github</span>
<span class="n">gh</span> <span class="o">=</span> <span class="n">Github</span><span class="p">(</span><span class="n">userdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'GH_TOKEN'</span><span class="p">))</span>
<span class="n">repo</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">get_repo</span><span class="p">(</span><span class="s1">'eddyjin1/colab'</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span>
<span class="n">post_filename</span> <span class="o">=</span> <span class="n">today</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span> <span class="n">html_filename</span>
<span class="n">post_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'docs/_posts/'</span><span class="p">,</span> <span class="n">post_filename</span><span class="p">)</span>

<span class="n">repo</span><span class="o">.</span><span class="n">create_file</span><span class="p">(</span><span class="n">post_path</span><span class="p">,</span> <span class="s1">'commit message'</span><span class="p">,</span> <span class="n">body_content</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="s1">'gh-pages'</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">GithubException</span>                           Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-16-6c3766dddb1a&gt;</span> in <span class="ansi-cyan-fg">&lt;cell line: 25&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span> post_path <span class="ansi-blue-fg">=</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;docs/_posts/&#39;</span><span class="ansi-blue-fg">,</span> post_filename<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     24</span> 
<span class="ansi-green-fg">---&gt; 25</span><span class="ansi-red-fg"> </span>repo<span class="ansi-blue-fg">.</span>create_file<span class="ansi-blue-fg">(</span>post_path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;commit message&#39;</span><span class="ansi-blue-fg">,</span> body_content<span class="ansi-blue-fg">,</span> branch<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;gh-pages&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.10/dist-packages/github/Repository.py</span> in <span class="ansi-cyan-fg">create_file</span><span class="ansi-blue-fg">(self, path, message, content, branch, committer, author)</span>
<span class="ansi-green-intense-fg ansi-bold">   2383</span>             put_parameters<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;committer&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> committer<span class="ansi-blue-fg">.</span>_identity
<span class="ansi-green-intense-fg ansi-bold">   2384</span> 
<span class="ansi-green-fg">-&gt; 2385</span><span class="ansi-red-fg">         headers, data = self._requester.requestJsonAndCheck(
</span><span class="ansi-green-intense-fg ansi-bold">   2386</span>             <span class="ansi-blue-fg">&#34;PUT&#34;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   2387</span>             <span class="ansi-blue-fg">f&#34;{self.url}/contents/{urllib.parse.quote(path)}&#34;</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/usr/local/lib/python3.10/dist-packages/github/Requester.py</span> in <span class="ansi-cyan-fg">requestJsonAndCheck</span><span class="ansi-blue-fg">(self, verb, url, parameters, headers, input)</span>
<span class="ansi-green-intense-fg ansi-bold">    535</span>         input<span class="ansi-blue-fg">:</span> Optional<span class="ansi-blue-fg">[</span>Any<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span>     ) -&gt; Tuple[Dict[str, Any], Any]:
<span class="ansi-green-fg">--&gt; 537</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>__check<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>requestJson<span class="ansi-blue-fg">(</span>verb<span class="ansi-blue-fg">,</span> url<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> headers<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>__customConnection<span class="ansi-blue-fg">(</span>url<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    538</span> 
<span class="ansi-green-intense-fg ansi-bold">    539</span>     def requestMultipartAndCheck(

<span class="ansi-green-fg">/usr/local/lib/python3.10/dist-packages/github/Requester.py</span> in <span class="ansi-cyan-fg">__check</span><span class="ansi-blue-fg">(self, status, responseHeaders, output)</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span>         data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>__structuredFromJson<span class="ansi-blue-fg">(</span>output<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    597</span>         <span class="ansi-green-fg">if</span> status <span class="ansi-blue-fg">&gt;=</span> <span class="ansi-cyan-fg">400</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 598</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> self<span class="ansi-blue-fg">.</span>createException<span class="ansi-blue-fg">(</span>status<span class="ansi-blue-fg">,</span> responseHeaders<span class="ansi-blue-fg">,</span> data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    599</span>         <span class="ansi-green-fg">return</span> responseHeaders<span class="ansi-blue-fg">,</span> data
<span class="ansi-green-intense-fg ansi-bold">    600</span> 

<span class="ansi-red-fg">GithubException</span>: 422 {&#34;message&#34;: &#34;Invalid request.\n\n\&#34;sha\&#34; wasn&#39;t supplied.&#34;, &#34;documentation_url&#34;: &#34;https://docs.github.com/rest/repos/contents#create-or-update-file-contents&#34;}</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>For more tutorials and colabs, visit <a href="https://www.colabcademy.com">https://www.colabcademy.com</a></p>
<p>© 2024 Eddy Jin</p>

</div>
</div>
</div>
</div>
